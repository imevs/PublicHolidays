import{j as e,r,u as R,S as z,A as G,_ as T}from"./index-BGAoQQ0r.js";import{f as P,g as w,a as K,c as V,b as I,d as O,e as H,h as q,u as J,s as E,C as U,i as Q}from"./generateICS-C_gm3pOk.js";function X(t){return t.flatMap(n=>n.holidays.map(c=>({...c,kind:"publicHoliday",country:n.countryName,countryCode:n.countryCode})))}const Z="_eventsList_7tzul_1",Y="_eventsWrapper_7tzul_7",ee="_dateEvents_7tzul_24",te="_eventsDate_7tzul_28",ne="_events_7tzul_1",g={eventsList:Z,eventsWrapper:Y,dateEvents:ee,eventsDate:te,events:ne};function oe({selectedYearDays:t,currentDate:n,mode:c,countryData:o}){return e.jsx("div",{className:g.eventsList,children:e.jsx("div",{className:g.eventsWrapper,children:t.filter(s=>c==="month"?s.date.getMonth()===n.getMonth():!0).filter(s=>s.events.length).map(s=>e.jsxs("div",{className:g.dateEvents,children:[e.jsx("div",{className:g.eventsDate,children:e.jsx("b",{children:P(s.date)})}),s.events.map(a=>a.kind==="publicHoliday"?e.jsxs("div",{className:g.events,children:[e.jsxs("span",{children:[w(a.countryCode),"Â "]}),e.jsxs("strong",{children:[a.country,"Â "]}),e.jsx("a",{target:"_blank",href:K(a.date,a.country,a.name,o),children:a.name})]},a.name+a.countryCode):e.jsxs("div",{className:g.events,children:[a.icon," ",a.name]},a.name))]},s.date.valueOf()))})})}const se="_controlGroup_13xw2_1",ae="_controlGroupLabel_13xw2_6",ce="_countryFilter_13xw2_13",ie="_toggleFilter_13xw2_19",re="_countryChip_13xw2_20",le="_active_13xw2_33",de="_checkboxContainer_13xw2_44",ue="_checkbox_13xw2_44",he="_checkboxLabel_13xw2_67",m={controlGroup:se,controlGroupLabel:ae,countryFilter:ce,toggleFilter:ie,countryChip:re,active:le,checkboxContainer:de,checkbox:ue,checkboxLabel:he},me=({selectedCountries:t,showAllCountries:n,onToggleCountry:c,setShowAllCountries:o,setShowAllHolidays:s})=>{const[a,x]=r.useState(!1),[h,_]=r.useState(!1);return r.useEffect(()=>{t.length===0&&o(!0)},[o,t]),r.useEffect(()=>{s(!h)},[h]),e.jsxs("div",{className:m.controlGroup,children:[e.jsx("label",{className:m.controlGroupLabel,children:"Select Countries"}),e.jsxs("div",{className:m.checkboxContainer,children:[e.jsx("input",{type:"checkbox",id:"showExtraHolidaysOnly",className:m.checkbox,checked:h,onChange:()=>_(!h)}),e.jsx("label",{htmlFor:"showExtraHolidaysOnly",className:m.checkboxLabel,children:"Show only extra holidays"}),e.jsx("input",{type:"checkbox",id:"showTimezones",className:m.checkbox,checked:a,onChange:()=>x(!a)}),e.jsx("label",{htmlFor:"showTimezones",className:m.checkboxLabel,children:n?"Show timezones":"Show local time"})]}),e.jsxs("div",{className:m.countryFilter,children:[Object.entries(V).filter(([l])=>n||t.includes(l)).map(([l,b])=>e.jsxs("div",{className:`${m.countryChip} ${t.includes(l)?m.active:""}`,onClick:()=>c(l),title:"Current time: "+O(l),children:[w(l)," ",b,a&&e.jsx("span",{className:m.offset,children:n?I[l]?` (UTC${I[l]})`:"":" - "+O(l)})]},l)),e.jsx("div",{className:`${m.toggleFilter}`,onClick:()=>o(!n),children:n?"Hide inactive":"Show all"})]})]})},_e="_actionButton_w4ypo_1",pe="_actionButtonContainer_w4ypo_6",fe="_panel_w4ypo_15",xe="_buttonIcon_w4ypo_27",u={actionButton:_e,actionButtonContainer:pe,panel:fe,buttonIcon:xe},ve="_panel_vofw8_1",ge="_open_vofw8_26",be="_closed_vofw8_32",ye="_panelHeader_vofw8_38",Ne="_toggleButton_vofw8_50",je="_toggleIcon_vofw8_83",Ce="_panelContent_vofw8_89",v={panel:ve,open:ge,closed:be,panelHeader:ye,toggleButton:Ne,toggleIcon:je,panelContent:Ce},Se=({isOpen:t,onToggle:n,toggleLabel:c,children:o,id:s})=>e.jsxs("div",{id:s,className:`${v.panel} ${t?v.open:v.closed}`,role:"region","aria-label":"Actions panel",children:[e.jsx("div",{className:v.panelHeader,children:e.jsx("button",{className:v.toggleButton,onClick:n,"aria-expanded":t,"aria-label":c,title:c,children:e.jsx("span",{className:v.toggleIcon,children:t?"âœ•":"âš™ï¸"})})}),e.jsx("div",{className:v.panelContent,children:o})]});function ke(t=600){const n=r.useRef(null),[c,o]=r.useState(!1);return r.useEffect(()=>{const s=n.current;if(!s)return;const a=new ResizeObserver(h=>{for(let _ of h){const l=_.contentRect.width;o(l<t)}});a.observe(s);const x=s.offsetWidth;return o(x<t),()=>{a.disconnect()}},[t]),[c,n]}const B="START_NOTIFICATIONS",Ee="STOP_NOTIFICATIONS",we="CHECK_NOTIFICATIONS",Te="NOTIFICATIONS_SET";async function Ie(t){return"Notification"in window?Notification.permission==="default"&&!t?await Notification.requestPermission()==="granted":Notification.permission==="granted":!1}const W="serviceWorker"in navigator;async function Oe(t){if(!W)return console.error("âŒ Service Worker not supported"),null;if(d)return d;try{return await navigator.serviceWorker.register("./SW.js"),await navigator.serviceWorker.ready,console.log("âœ… Service Worker active"),navigator.serviceWorker.addEventListener("message",n=>{n.data.type===Te&&t(n.data.status)}),navigator.serviceWorker.controller}catch(n){return console.error("Service Worker registration failed:",n),null}}let d;async function F(t,n,c){if(await Ie(n)){d=await Oe(c);const s=localStorage.getItem("sw_data");n?s&&(d==null||d.postMessage({type:B,events:JSON.parse(s)})):(d==null||d.postMessage({type:B,events:t}),localStorage.setItem("sw_data",JSON.stringify(t))),$()}}function $(){d==null||d.postMessage({type:we})}function He(){d==null||d.postMessage({type:Ee}),localStorage.removeItem("sw_data"),$()}function M(t){return Array.from(new Set((t??[]).flatMap(n=>n.events.filter(c=>c.kind==="publicHoliday").map(c=>c.country).filter(Boolean))))}const Be=({selectedYearDays:t,viewMode:n,toggleMode:c})=>{const o=R(),[s,a]=r.useState(!1),[x,h]=r.useState(!1),[_,l]=ke(600);r.useEffect(()=>{F([],!0,a)},[]);const b=()=>{const p=(t??[]).flatMap(f=>f.events.filter(i=>i.kind==="publicHoliday").map(i=>`${q(f.date)} ${w(i.countryCode)} ${i.country}: ${i.name}`)).filter(Boolean).join(`
`);localStorage.setItem(z,p),o(`/${G}/EditEvents`)},S=()=>{const p=M(t),f=t.map(i=>i.events).flat();H(f,p.join("_")+"_calendar")},y=()=>{const p=(t??[]).flatMap(i=>i.events.filter(j=>j.kind==="publicHoliday"));M(t).forEach(i=>{const j=p.filter(A=>A.country===i);j.length&&H(j,i+"_calendar")})},k=r.useCallback(()=>{s?He():F(t.flatMap(p=>p.events.filter(f=>f.kind==="publicHoliday")),!1,a)},[s,a]),N=e.jsxs(e.Fragment,{children:[W&&e.jsxs("button",{className:u.actionButton,onClick:k,children:[e.jsx("span",{className:u.buttonIcon,children:s?"ðŸ”•":"ðŸ””"}),s?"Disable notifications":"Get notifications"]}),e.jsxs("button",{className:u.actionButton,onClick:c,children:[e.jsx("span",{className:u.buttonIcon,children:n==="month"?"ðŸ—“ï¸":"ðŸ“…"}),n==="month"?"Switch to year mode":"Switch to month mode"]}),e.jsxs("button",{className:u.actionButton,onClick:y,children:[e.jsx("span",{className:u.buttonIcon,children:"ðŸ“¥"}),"Download separate ICS files"]}),e.jsxs("button",{className:u.actionButton,onClick:S,children:[e.jsx("span",{className:u.buttonIcon,children:"ðŸ“¥"}),"Download combined ICS file"]}),e.jsxs("button",{className:u.actionButton,onClick:b,style:{right:120},children:[e.jsx("span",{className:u.buttonIcon,children:"âœï¸"}),"Create custom calendar"]})]});return e.jsx("div",{ref:l,children:_?e.jsx(Se,{isOpen:x,onToggle:()=>h(!x),toggleLabel:"Actions",id:"actions-panel",children:e.jsx("div",{className:`${u.actionButtonContainer} ${u.panel}`,children:N})}):e.jsx("div",{className:u.actionButtonContainer,children:N})})},Fe="_themeSelector_1ltjd_1",Me="_label_1ltjd_23",Le="_labelText_1ltjd_40",De="_select_1ltjd_55",C={themeSelector:Fe,label:Me,labelText:Le,select:De},We=[{id:"neutral",name:"Neutral",icon:"âšª"},{id:"vibrant",name:"Vibrant",icon:"ðŸŽ¨"},{id:"dark",name:"Dark",icon:"ðŸŒ™"},{id:"ocean",name:"Ocean",icon:"ðŸŒŠ"},{id:"sunset",name:"Sunset",icon:"ðŸŒ…"},{id:"ios",name:"iOS",icon:"ðŸŽ"},{id:"material",name:"Material",icon:"ðŸ”·"}],L="theme",D="neutral",$e=()=>{const[t,n]=r.useState(()=>{try{return localStorage.getItem(L)||D}catch(o){return console.error("Failed to read theme from localStorage:",o),D}});r.useEffect(()=>{document.documentElement.setAttribute("data-theme",t);try{localStorage.setItem(L,t)}catch(o){console.error("Failed to save theme to localStorage:",o)}},[t]);const c=o=>{n(o)};return e.jsxs("div",{className:C.themeSelector,children:[e.jsx("label",{htmlFor:"theme-select",className:C.label,children:e.jsx("span",{className:C.labelText,children:"Theme"})}),e.jsx("select",{id:"theme-select",value:t,onChange:o=>c(o.target.value),className:C.select,"aria-label":"Select theme",children:We.map(o=>e.jsxs("option",{value:o.id,children:[o.icon," ",o.name]},o.id))})]})},ze=()=>{r.useEffect(()=>{T(async()=>{const{allHolidays:i}=await import("./index-BLBwjQb6.js");return{allHolidays:i}},[]).then(({allHolidays:i})=>{n(X(Object.values(i)))})},[]);const[t,n]=r.useState([]),[c,o]=r.useState(!1),{currentDate:s,selectedCountries:a,selectedMonthDays:x,selectedYearDays:h,mode:_,navigateMonth:l,toggleCountry:b,handleDateChange:S,handleModeChange:y,showAllCountries:k,setShowAllCountries:N}=J(t,c),[p,f]=r.useState({});return r.useEffect(()=>{T(()=>import("./all-CpPQXMCT.js"),[]).then(i=>{f(i.descriptions)})},[]),e.jsxs("div",{className:E.app,children:[e.jsx($e,{}),e.jsxs("div",{className:E.header,children:[e.jsx("h1",{children:e.jsx("a",{href:"./",children:"ðŸŒ Public Holidays Calendar"})}),e.jsx("p",{children:"Track public holidays across multiple countries"})]}),e.jsxs("div",{className:E.container,children:[e.jsx(U,{selectedDate:s,onDateChange:S,onNavigateMonth:l,extraControls:e.jsx(me,{showAllCountries:k,setShowAllCountries:N,selectedCountries:a,onToggleCountry:b,setShowAllHolidays:o})}),e.jsx(Be,{selectedYearDays:h,viewMode:_,toggleMode:()=>y(_==="month"?"year":"month",s.getMonth())}),e.jsx(Q,{selectedYearDays:h,selectedMonthDays:x,currentDate:s,mode:_,onModeChange:y,countryData:p}),e.jsx(oe,{selectedYearDays:h,currentDate:s,mode:_,countryData:p})]})]})};export{ze as Holidays,ze as default};
