import{r as c,j as t,a as I,S as C}from"./index-C0nAr8sK.js";import{p as w,g as E,e as N,u as b,s as j,C as S,i as k}from"./generateICS-Craui9H6.js";const M="_container_sw4sd_1",T="_label_sw4sd_28",Y="_wrapper_sw4sd_35",$="_icons_sw4sd_40",F="_lineRow_sw4sd_49",G="_indicator_sw4sd_61",L="_indicatorInvalid_sw4sd_80",A="_textarea_sw4sd_87",f={container:M,label:T,wrapper:Y,icons:$,lineRow:F,indicator:G,indicatorInvalid:L,textarea:A},B=[2023,2024,2025,2026,2027];function U(n){return n.split(`
`).map(e=>e.trim()).filter(e=>e.length).flatMap(e=>{const o=e.split(" "),[a,l,...s]=o,d=_(l)?s.join(" "):l+" "+s.join(" ");return a.split("-").length===3?{name:d,icon:_(l)?l:"",date:a,kind:"other",localName:d}:B.map(h=>({name:d,icon:_(l)?l:"",date:`${h}-${a}`,kind:"other",localName:d}))})}function _(n){return n?n.length===1?!0:new RegExp("(\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F)","u").test(n):!1}function R(n){const e=n.trim();if(!e)return{valid:!1,error:"Empty line"};const o=e.split(/\s+/);if(o.length<2)return{valid:!1,error:"Expect at least date and name"};const a=o[0];if(!/^(\d{4}-)?\d{2}-\d{2}$/.test(a))return{valid:!1,error:"Date must be YYYY-MM-DD or MM-DD"};const s=new Date(a);return Number.isNaN(s.getTime())?{valid:!1,error:"Invalid date"}:{valid:!0}}function H(n){const e=c.useRef(null),o=c.useRef(null);return c.useEffect(()=>{const l=n.dataText.split(`
`).map(s=>s.trim()).filter(s=>s.length).filter(s=>R(s).valid).join(`
`);n.setHolidaysData(U(l))},[n.dataText]),c.useEffect(()=>{e.current&&new ResizeObserver(()=>{var a;o.current&&(o.current.style.height=((a=e.current)==null?void 0:a.clientHeight)+"px")}).observe(e.current)},[e.current]),t.jsxs("div",{className:f.container,children:[t.jsxs("label",{htmlFor:"events-data",className:f.label,children:["Calendar events. Format: ",t.jsx("code",{children:"YYYY-MM-DD [icon] event name"}),"."]}),t.jsxs("div",{className:f.wrapper,children:[t.jsx("div",{ref:o,className:f.icons,children:n.dataText.split(`
`).map((a,l)=>{const s=R(a);return t.jsx("div",{"data-tooltip":s.valid?void 0:s.error||"Invalid",className:f.lineRow,children:t.jsx("span",{className:`${f.indicator} ${s.valid?"":f.indicatorInvalid}`,children:s.valid?"":"!"})},l)})}),t.jsx("textarea",{id:"events-data",ref:e,value:n.dataText,onChange:a=>n.setDataText(a.target.value),onScroll:a=>{o.current&&(o.current.scrollTop=a.target.scrollTop)},className:f.textarea})]})]})}const O="_controls_136y5_1",q="_controlsGroup_136y5_13",y={controls:O,controlsGroup:q},z="https://api.codetabs.com/v1/proxy/?quest=";function D(n){return fetch(z+encodeURIComponent(n)).then(e=>e.text()).catch(e=>(console.error(e),""))}const J=({setDataText:n,setHolidaysData:e,holidaysParsed:o})=>{const[a]=I();c.useEffect(()=>{const r=a==null?void 0:a.get("ics");if(r){const i=encodeURI(r+window.location.hash).replace(/#/g,"%23").replace(/@/g,"%40");h(r),D(i).then(p)}},[]);const l=c.useRef(null),s=c.useRef(null),[d,h]=c.useState(""),p=c.useCallback(r=>{const i=w(r);e(i);const v=i.map(u=>`${u.date} ${u.kind==="other"?u.icon:E(u.countryCode)} ${u.name}`).join(`
`);n(v)},[n,e]),x=r=>{var u;const i=(u=r.target.files)==null?void 0:u[0];if(!i)return;const v=new FileReader;v.onload=()=>{p(String(v.result||"")),s.current&&(s.current.value="")},v.readAsText(i)},m=c.useCallback(()=>{var i;const r=((i=l.current)==null?void 0:i.value)||d;r&&D(r).then(p)},[d,p]),g=c.useCallback(()=>{N(o)},[o]);return t.jsxs("div",{className:y.controls,children:[t.jsxs("div",{className:y.controlsGroup,children:[t.jsx("input",{ref:l,value:d,type:"url",onChange:r=>h(r.target.value),placeholder:"Add link to .ICS file"}),t.jsx("button",{onClick:m,children:"Load ICS"})]}),t.jsx("button",{onClick:()=>{var r;return(r=s.current)==null?void 0:r.click()},children:"Import .ics"}),t.jsx("input",{ref:s,type:"file",accept:".ics,text/calendar",style:{display:"none"},onChange:x}),t.jsx("button",{onClick:g,children:"Save to .ics"})]})},K=`
2025-09-10 üéÇ Birthday of Joe
2025-09-19 üéÇ Birthday of Chuck
2025-09-27 üéÇ Birthday of Dima
`,V=()=>{const[n,e]=c.useState([]),{currentDate:o,selectedMonthDays:a,selectedYearDays:l,mode:s,navigateMonth:d,handleModeChange:h,handleDateChange:p}=b(n),[x,m]=c.useState(K.trim());c.useEffect(()=>{const r=localStorage.getItem(C);r!==null&&m(r)},[]),c.useEffect(()=>{localStorage.setItem(C,x)},[x]);const g=c.useCallback(r=>{m(i=>i+`
`+(r.date+" "+r.icon+" "+r.name))},[]);return t.jsxs("div",{className:j.app,children:[t.jsx("div",{className:j.header,children:t.jsx("h1",{children:t.jsx("a",{href:"./",children:"üåç Events Calendar"})})}),t.jsxs("div",{className:j.container,children:[t.jsx(S,{selectedDate:o,onDateChange:p,onNavigateMonth:d}),t.jsx(J,{setDataText:m,setHolidaysData:e,holidaysParsed:n}),t.jsx(k,{selectedYearDays:l,selectedMonthDays:a,currentDate:o,mode:s,countryData:{},onModeChange:h,onNewEvent:g}),t.jsx(H,{setHolidaysData:e,dataText:x,setDataText:m})]})]})};export{V as AnyEvents,V as default};
