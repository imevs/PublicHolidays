import{j as e,r,u as $,S as D,A,_ as E}from"./index-o16Pklzh.js";import{f as z,g as w,a as R,c as G,b as I,d as T,e as O,h as P,u as q,s as k,T as J,C as K,i as V}from"./ThemeSelector-yxRgwmBD.js";function U(t){return t.flatMap(n=>n.holidays.map(a=>({...a,kind:"publicHoliday",country:n.countryName,countryCode:n.countryCode})))}const Q="_eventsList_7tzul_1",X="_eventsWrapper_7tzul_7",Z="_dateEvents_7tzul_24",Y="_eventsDate_7tzul_28",ee="_events_7tzul_1",g={eventsList:Q,eventsWrapper:X,dateEvents:Z,eventsDate:Y,events:ee};function te({selectedYearDays:t,currentDate:n,mode:a,countryData:l}){return e.jsx("div",{className:g.eventsList,children:e.jsx("div",{className:g.eventsWrapper,children:t.filter(o=>a==="month"?o.date.getMonth()===n.getMonth():!0).filter(o=>o.events.length).map(o=>e.jsxs("div",{className:g.dateEvents,children:[e.jsx("div",{className:g.eventsDate,children:e.jsx("b",{children:z(o.date)})}),o.events.map(s=>s.kind==="publicHoliday"?e.jsxs("div",{className:g.events,children:[e.jsxs("span",{children:[w(s.countryCode),"Â "]}),e.jsxs("strong",{children:[s.country,"Â "]}),e.jsx("a",{target:"_blank",href:R(s.date,s.country,s.name,l),children:s.name})]},s.name+s.countryCode):e.jsxs("div",{className:g.events,children:[s.icon," ",s.name]},s.name))]},o.date.valueOf()))})})}const ne="_controlGroup_13xw2_1",oe="_controlGroupLabel_13xw2_6",se="_countryFilter_13xw2_13",ae="_toggleFilter_13xw2_19",ce="_countryChip_13xw2_20",ie="_active_13xw2_33",re="_checkboxContainer_13xw2_44",le="_checkbox_13xw2_44",de="_checkboxLabel_13xw2_67",p={controlGroup:ne,controlGroupLabel:oe,countryFilter:se,toggleFilter:ae,countryChip:ce,active:ie,checkboxContainer:re,checkbox:le,checkboxLabel:de},ue=({selectedCountries:t,showAllCountries:n,onToggleCountry:a,setShowAllCountries:l,setShowAllHolidays:o})=>{const[s,x]=r.useState(!1),[h,f]=r.useState(!1);return r.useEffect(()=>{t.length===0&&l(!0)},[l,t]),r.useEffect(()=>{o(!h)},[h]),e.jsxs("div",{className:p.controlGroup,children:[e.jsx("label",{className:p.controlGroupLabel,children:"Select Countries"}),e.jsxs("div",{className:p.checkboxContainer,children:[e.jsx("input",{type:"checkbox",id:"showExtraHolidaysOnly",className:p.checkbox,checked:h,onChange:()=>f(!h)}),e.jsx("label",{htmlFor:"showExtraHolidaysOnly",className:p.checkboxLabel,children:"Show only extra holidays"}),e.jsx("input",{type:"checkbox",id:"showTimezones",className:p.checkbox,checked:s,onChange:()=>x(!s)}),e.jsx("label",{htmlFor:"showTimezones",className:p.checkboxLabel,children:n?"Show timezones":"Show local time"})]}),e.jsxs("div",{className:p.countryFilter,children:[Object.entries(G).filter(([i])=>n||t.includes(i)).map(([i,y])=>e.jsxs("div",{className:`${p.countryChip} ${t.includes(i)?p.active:""}`,onClick:()=>a(i),title:"Current time: "+T(i),children:[w(i)," ",y,s&&e.jsx("span",{className:p.offset,children:n?I[i]?` (UTC${I[i]})`:"":" - "+T(i)})]},i)),e.jsx("div",{className:`${p.toggleFilter}`,onClick:()=>l(!n),children:n?"Hide inactive":"Show all"})]})]})},he="_actionButton_w4ypo_1",pe="_actionButtonContainer_w4ypo_6",fe="_panel_w4ypo_15",me="_buttonIcon_w4ypo_27",u={actionButton:he,actionButtonContainer:pe,panel:fe,buttonIcon:me},_e="_panel_vofw8_1",xe="_open_vofw8_26",ve="_closed_vofw8_32",ge="_panelHeader_vofw8_38",ye="_toggleButton_vofw8_50",Ne="_toggleIcon_vofw8_83",be="_panelContent_vofw8_89",v={panel:_e,open:xe,closed:ve,panelHeader:ge,toggleButton:ye,toggleIcon:Ne,panelContent:be},je=({isOpen:t,onToggle:n,toggleLabel:a,children:l,id:o})=>e.jsxs("div",{id:o,className:`${v.panel} ${t?v.open:v.closed}`,role:"region","aria-label":"Actions panel",children:[e.jsx("div",{className:v.panelHeader,children:e.jsx("button",{className:v.toggleButton,onClick:n,"aria-expanded":t,"aria-label":a,title:a,children:e.jsx("span",{className:v.toggleIcon,children:t?"âœ•":"âš™ï¸"})})}),e.jsx("div",{className:v.panelContent,children:l})]});function Ce(t=600){const n=r.useRef(null),[a,l]=r.useState(!1);return r.useEffect(()=>{const o=n.current;if(!o)return;const s=new ResizeObserver(h=>{for(let f of h){const i=f.contentRect.width;l(i<t)}});s.observe(o);const x=o.offsetWidth;return l(x<t),()=>{s.disconnect()}},[t]),[a,n]}const B="START_NOTIFICATIONS",Se="STOP_NOTIFICATIONS",ke="CHECK_NOTIFICATIONS",we="NOTIFICATIONS_SET";async function Ee(t){return"Notification"in window?Notification.permission==="default"&&!t?await Notification.requestPermission()==="granted":Notification.permission==="granted":!1}const M="serviceWorker"in navigator;async function Ie(t){if(!M)return console.error("âŒ Service Worker not supported"),null;if(d)return d;try{return await navigator.serviceWorker.register("./SW.js"),await navigator.serviceWorker.ready,console.log("âœ… Service Worker active"),navigator.serviceWorker.addEventListener("message",n=>{n.data.type===we&&t(n.data.status)}),navigator.serviceWorker.controller}catch(n){return console.error("Service Worker registration failed:",n),null}}let d;async function H(t,n,a){if(await Ee(n)){d=await Ie(a);const o=localStorage.getItem("sw_data");n?o&&(d==null||d.postMessage({type:B,events:JSON.parse(o)})):(d==null||d.postMessage({type:B,events:t}),localStorage.setItem("sw_data",JSON.stringify(t))),W()}}function W(){d==null||d.postMessage({type:ke})}function Te(){d==null||d.postMessage({type:Se}),localStorage.removeItem("sw_data"),W()}function L(t){return Array.from(new Set((t??[]).flatMap(n=>n.events.filter(a=>a.kind==="publicHoliday").map(a=>a.country).filter(Boolean))))}const Oe=({selectedYearDays:t,viewMode:n,toggleMode:a})=>{const l=$(),[o,s]=r.useState(!1),[x,h]=r.useState(!1),[f,i]=Ce(600);r.useEffect(()=>{H([],!0,s)},[]);const y=()=>{const m=(t??[]).flatMap(_=>_.events.filter(c=>c.kind==="publicHoliday").map(c=>`${P(_.date)} ${w(c.countryCode)} ${c.country}: ${c.name}`)).filter(Boolean).join(`
`);localStorage.setItem(D,m),l(`/${A}/EditEvents`)},C=()=>{const m=L(t),_=t.map(c=>c.events).flat();O(_,m.join("_")+"_calendar")},N=()=>{const m=(t??[]).flatMap(c=>c.events.filter(j=>j.kind==="publicHoliday"));L(t).forEach(c=>{const j=m.filter(F=>F.country===c);j.length&&O(j,c+"_calendar")})},S=r.useCallback(()=>{o?Te():H(t.flatMap(m=>m.events.filter(_=>_.kind==="publicHoliday")),!1,s)},[o,s]),b=e.jsxs(e.Fragment,{children:[M&&e.jsxs("button",{className:u.actionButton,onClick:S,children:[e.jsx("span",{className:u.buttonIcon,children:o?"ðŸ”•":"ðŸ””"}),o?"Disable notifications":"Get notifications"]}),e.jsxs("button",{className:u.actionButton,onClick:a,children:[e.jsx("span",{className:u.buttonIcon,children:n==="month"?"ðŸ—“ï¸":"ðŸ“…"}),n==="month"?"Switch to year mode":"Switch to month mode"]}),e.jsxs("button",{className:u.actionButton,onClick:N,children:[e.jsx("span",{className:u.buttonIcon,children:"ðŸ“¥"}),"Download separate ICS files"]}),e.jsxs("button",{className:u.actionButton,onClick:C,children:[e.jsx("span",{className:u.buttonIcon,children:"ðŸ“¥"}),"Download combined ICS file"]}),e.jsxs("button",{className:u.actionButton,onClick:y,style:{right:120},children:[e.jsx("span",{className:u.buttonIcon,children:"âœï¸"}),"Create custom calendar"]})]});return e.jsx("div",{ref:i,children:f?e.jsx(je,{isOpen:x,onToggle:()=>h(!x),toggleLabel:"Actions",id:"actions-panel",children:e.jsx("div",{className:`${u.actionButtonContainer} ${u.panel}`,children:b})}):e.jsx("div",{className:u.actionButtonContainer,children:b})})},Le=()=>{r.useEffect(()=>{E(async()=>{const{allHolidays:c}=await import("./index-BLBwjQb6.js");return{allHolidays:c}},[]).then(({allHolidays:c})=>{n(U(Object.values(c)))})},[]);const[t,n]=r.useState([]),[a,l]=r.useState(!1),{currentDate:o,selectedCountries:s,selectedMonthDays:x,selectedYearDays:h,mode:f,navigateMonth:i,toggleCountry:y,handleDateChange:C,handleModeChange:N,showAllCountries:S,setShowAllCountries:b}=q(t,a),[m,_]=r.useState({});return r.useEffect(()=>{E(()=>import("./all-CpPQXMCT.js"),[]).then(c=>{_(c.descriptions)})},[]),e.jsxs("div",{className:k.app,children:[e.jsx(J,{}),e.jsxs("div",{className:k.header,children:[e.jsx("h1",{children:e.jsx("a",{href:"./",children:"ðŸŒ Public Holidays Calendar"})}),e.jsx("p",{children:"Track public holidays across multiple countries"})]}),e.jsxs("div",{className:k.container,children:[e.jsx(K,{selectedDate:o,onDateChange:C,onNavigateMonth:i,extraControls:e.jsx(ue,{showAllCountries:S,setShowAllCountries:b,selectedCountries:s,onToggleCountry:y,setShowAllHolidays:l})}),e.jsx(Oe,{selectedYearDays:h,viewMode:f,toggleMode:()=>N(f==="month"?"year":"month",o.getMonth())}),e.jsx(V,{selectedYearDays:h,selectedMonthDays:x,currentDate:o,mode:f,onModeChange:N,countryData:m}),e.jsx(te,{selectedYearDays:h,currentDate:o,mode:f,countryData:m})]})]})};export{Le as Holidays,Le as default};
