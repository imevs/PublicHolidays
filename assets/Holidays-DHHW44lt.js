import{j as e,r as u,u as A,S as B,A as $,_ as k}from"./index-CIVOs3tC.js";import{f as G,g as C,a as z,c as P,b as E,d as T,e as I,h as R,u as K,s as j,C as V,i as q}from"./generateICS-B3n_0dDF.js";function J(t){return t.flatMap(n=>n.holidays.map(c=>({...c,kind:"publicHoliday",country:n.countryName,countryCode:n.countryCode})))}const U="_eventsList_7tzul_1",Q="_eventsWrapper_7tzul_7",X="_dateEvents_7tzul_24",Z="_eventsDate_7tzul_28",Y="_events_7tzul_1",v={eventsList:U,eventsWrapper:Q,dateEvents:X,eventsDate:Z,events:Y};function ee({selectedYearDays:t,currentDate:n,mode:c,countryData:o}){return e.jsx("div",{className:v.eventsList,children:e.jsx("div",{className:v.eventsWrapper,children:t.filter(a=>c==="month"?a.date.getMonth()===n.getMonth():!0).filter(a=>a.events.length).map(a=>e.jsxs("div",{className:v.dateEvents,children:[e.jsx("div",{className:v.eventsDate,children:e.jsx("b",{children:G(a.date)})}),a.events.map(s=>s.kind==="publicHoliday"?e.jsxs("div",{className:v.events,children:[e.jsxs("span",{children:[C(s.countryCode),"Â "]}),e.jsxs("strong",{children:[s.country,"Â "]}),e.jsx("a",{target:"_blank",href:z(s.date,s.country,s.name,o),children:s.name})]},s.name+s.countryCode):e.jsxs("div",{className:v.events,children:[s.icon," ",s.name]},s.name))]},a.date.valueOf()))})})}const te="_controlGroup_13xw2_1",ne="_controlGroupLabel_13xw2_6",oe="_countryFilter_13xw2_13",ae="_toggleFilter_13xw2_19",se="_countryChip_13xw2_20",ce="_active_13xw2_33",ie="_checkboxContainer_13xw2_44",re="_checkbox_13xw2_44",le="_checkboxLabel_13xw2_67",d={controlGroup:te,controlGroupLabel:ne,countryFilter:oe,toggleFilter:ae,countryChip:se,active:ce,checkboxContainer:ie,checkbox:re,checkboxLabel:le},ue=({selectedCountries:t,showAllCountries:n,onToggleCountry:c,setShowAllCountries:o,setShowAllHolidays:a})=>{const[s,b]=u.useState(!1),[p,_]=u.useState(!1);return u.useEffect(()=>{t.length===0&&o(!0)},[o,t]),u.useEffect(()=>{a(!p)},[p]),e.jsxs("div",{className:d.controlGroup,children:[e.jsx("label",{className:d.controlGroupLabel,children:"Select Countries"}),e.jsxs("div",{className:d.checkboxContainer,children:[e.jsx("input",{type:"checkbox",id:"showExtraHolidaysOnly",className:d.checkbox,checked:p,onChange:()=>_(!p)}),e.jsx("label",{htmlFor:"showExtraHolidaysOnly",className:d.checkboxLabel,children:"Show only extra holidays"}),e.jsx("input",{type:"checkbox",id:"showTimezones",className:d.checkbox,checked:s,onChange:()=>b(!s)}),e.jsx("label",{htmlFor:"showTimezones",className:d.checkboxLabel,children:n?"Show timezones":"Show local time"})]}),e.jsxs("div",{className:d.countryFilter,children:[Object.entries(P).filter(([l])=>n||t.includes(l)).map(([l,h])=>e.jsxs("div",{className:`${d.countryChip} ${t.includes(l)?d.active:""}`,onClick:()=>c(l),title:"Current time: "+T(l),children:[C(l)," ",h,s&&e.jsx("span",{className:d.offset,children:n?E[l]?` (UTC${E[l]})`:"":" - "+T(l)})]},l)),e.jsx("div",{className:`${d.toggleFilter}`,onClick:()=>o(!n),children:n?"Hide inactive":"Show all"})]})]})},de="_actionButton_aamop_1",he="_actionButtonContainer_aamop_6",me="_buttonIcon_aamop_14",m={actionButton:de,actionButtonContainer:he,buttonIcon:me},w="START_NOTIFICATIONS",pe="STOP_NOTIFICATIONS",fe="CHECK_NOTIFICATIONS",_e="NOTIFICATIONS_SET";async function xe(t){return"Notification"in window?Notification.permission==="default"&&!t?await Notification.requestPermission()==="granted":Notification.permission==="granted":!1}const L="serviceWorker"in navigator;async function ve(t){if(!L)return console.error("âŒ Service Worker not supported"),null;if(r)return r;try{return await navigator.serviceWorker.register("./SW.js"),await navigator.serviceWorker.ready,console.log("âœ… Service Worker active"),navigator.serviceWorker.addEventListener("message",n=>{n.data.type===_e&&t(n.data.status)}),navigator.serviceWorker.controller}catch(n){return console.error("Service Worker registration failed:",n),null}}let r;async function O(t,n,c){if(await xe(n)){r=await ve(c);const a=localStorage.getItem("sw_data");n?a&&(r==null||r.postMessage({type:w,events:JSON.parse(a)})):(r==null||r.postMessage({type:w,events:t}),localStorage.setItem("sw_data",JSON.stringify(t))),D()}}function D(){r==null||r.postMessage({type:fe})}function be(){r==null||r.postMessage({type:pe}),localStorage.removeItem("sw_data"),D()}function M(t){return Array.from(new Set((t??[]).flatMap(n=>n.events.filter(c=>c.kind==="publicHoliday").map(c=>c.country).filter(Boolean))))}const ye=({selectedYearDays:t,viewMode:n,toggleMode:c})=>{const o=A(),[a,s]=u.useState(!1);u.useEffect(()=>{O([],!0,s)},[]);const b=()=>{const h=(t??[]).flatMap(f=>f.events.filter(i=>i.kind==="publicHoliday").map(i=>`${R(f.date)} ${C(i.countryCode)} ${i.country}: ${i.name}`)).filter(Boolean).join(`
`);localStorage.setItem(B,h),o(`/${$}/EditEvents`)},p=()=>{const h=M(t),f=t.map(i=>i.events).flat();I(f,h.join("_")+"_calendar")},_=()=>{const h=(t??[]).flatMap(i=>i.events.filter(x=>x.kind==="publicHoliday"));M(t).forEach(i=>{const x=h.filter(N=>N.country===i);x.length&&I(x,i+"_calendar")})},l=u.useCallback(()=>{a?be():O(t.flatMap(h=>h.events.filter(f=>f.kind==="publicHoliday")),!1,s)},[a,s]);return e.jsxs("div",{className:m.actionButtonContainer,children:[L&&e.jsxs("button",{className:m.actionButton,onClick:l,children:[e.jsx("span",{className:m.buttonIcon,children:a?"ðŸ”•":"ðŸ””"}),a?"Disable notifications":"Get notifications"]}),e.jsxs("button",{className:m.actionButton,onClick:c,children:[e.jsx("span",{className:m.buttonIcon,children:n==="month"?"ðŸ—“ï¸":"ðŸ“…"}),n==="month"?"Switch to year mode":"Switch to month mode"]}),e.jsxs("button",{className:m.actionButton,onClick:_,children:[e.jsx("span",{className:m.buttonIcon,children:"ðŸ“¥"}),"Download separate ICS files"]}),e.jsxs("button",{className:m.actionButton,onClick:p,children:[e.jsx("span",{className:m.buttonIcon,children:"ðŸ“¥"}),"Download combined ICS file"]}),e.jsxs("button",{className:m.actionButton,onClick:b,style:{right:120},children:[e.jsx("span",{className:m.buttonIcon,children:"âœï¸"}),"Create custom calendar"]})]})},ge="_themeSelector_fmph7_1",Ne="_label_fmph7_23",je="_labelText_fmph7_40",Ce="_select_fmph7_55",g={themeSelector:ge,label:Ne,labelText:je,select:Ce},Se=[{id:"neutral",name:"Neutral",icon:"âšª"},{id:"vibrant",name:"Vibrant",icon:"ðŸŽ¨"},{id:"dark",name:"Dark",icon:"ðŸŒ™"},{id:"ocean",name:"Ocean",icon:"ðŸŒŠ"},{id:"sunset",name:"Sunset",icon:"ðŸŒ…"},{id:"ios",name:"iOS",icon:"ðŸŽ"},{id:"material",name:"Material",icon:"ðŸ”·"}],F="theme",H="neutral",ke=()=>{const[t,n]=u.useState(()=>{try{return localStorage.getItem(F)||H}catch(o){return console.error("Failed to read theme from localStorage:",o),H}});u.useEffect(()=>{document.documentElement.setAttribute("data-theme",t);try{localStorage.setItem(F,t)}catch(o){console.error("Failed to save theme to localStorage:",o)}},[t]);const c=o=>{n(o)};return e.jsxs("div",{className:g.themeSelector,children:[e.jsx("label",{htmlFor:"theme-select",className:g.label,children:e.jsx("span",{className:g.labelText,children:"Theme"})}),e.jsx("select",{id:"theme-select",value:t,onChange:o=>c(o.target.value),className:g.select,"aria-label":"Select theme",children:Se.map(o=>e.jsxs("option",{value:o.id,children:[o.icon," ",o.name]},o.id))})]})},Ie=()=>{u.useEffect(()=>{k(async()=>{const{allHolidays:y}=await import("./index-BLBwjQb6.js");return{allHolidays:y}},[]).then(({allHolidays:y})=>{n(J(Object.values(y)))})},[]);const[t,n]=u.useState([]),[c,o]=u.useState(!1),{currentDate:a,selectedCountries:s,selectedMonthDays:b,selectedYearDays:p,mode:_,navigateMonth:l,toggleCountry:h,handleDateChange:f,handleModeChange:i,showAllCountries:x,setShowAllCountries:N}=K(t,c),[S,W]=u.useState({});return u.useEffect(()=>{k(()=>import("./all-CpPQXMCT.js"),[]).then(y=>{W(y.descriptions)})},[]),e.jsxs("div",{className:j.app,children:[e.jsx(ke,{}),e.jsxs("div",{className:j.header,children:[e.jsx("h1",{children:e.jsx("a",{href:"./",children:"ðŸŒ Public Holidays Calendar"})}),e.jsx("p",{children:"Track public holidays across multiple countries"})]}),e.jsxs("div",{className:j.container,children:[e.jsx(V,{selectedDate:a,onDateChange:f,onNavigateMonth:l,extraControls:e.jsx(ue,{showAllCountries:x,setShowAllCountries:N,selectedCountries:s,onToggleCountry:h,setShowAllHolidays:o})}),e.jsx(ye,{selectedYearDays:p,viewMode:_,toggleMode:()=>i(_==="month"?"year":"month",a.getMonth())}),e.jsx(q,{selectedYearDays:p,selectedMonthDays:b,currentDate:a,mode:_,onModeChange:i,countryData:S}),e.jsx(ee,{selectedYearDays:p,currentDate:a,mode:_,countryData:S})]})]})};export{Ie as Holidays,Ie as default};
