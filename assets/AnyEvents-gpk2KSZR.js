import{r as c,j as t,a as y,S as C}from"./index-Dp3GpNt-.js";import{p as E,g as N,e as b,u as S,s as j,C as k,i as w}from"./generateICS-CFN0rtit.js";const M="_container_17xxl_1",T="_label_17xxl_28",Y="_wrapper_17xxl_35",$="_icons_17xxl_40",F="_lineRow_17xxl_49",G="_indicator_17xxl_61",L="_indicatorInvalid_17xxl_80",A="_textarea_17xxl_87",x={container:M,label:T,wrapper:Y,icons:$,lineRow:F,indicator:G,indicatorInvalid:L,textarea:A},B=[2023,2024,2025,2026,2027];function U(n){return n.split(`
`).map(e=>e.trim()).filter(e=>e.length).flatMap(e=>{const o=e.split(" "),[a,l,...s]=o,d=_(l)?s.join(" "):l+" "+s.join(" ");return a.split("-").length===3?{name:d,icon:_(l)?l:"",date:a,kind:"other",localName:d}:B.map(f=>({name:d,icon:_(l)?l:"",date:`${f}-${a}`,kind:"other",localName:d}))})}function _(n){return n?n.length===1?!0:new RegExp("(\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F)","u").test(n):!1}function R(n){const e=n.trim();if(!e)return{valid:!1,error:"Empty line"};const o=e.split(/\s+/);if(o.length<2)return{valid:!1,error:"Expect at least date and name"};const a=o[0];if(!/^(\d{4}-)?\d{2}-\d{2}$/.test(a))return{valid:!1,error:"Date must be YYYY-MM-DD or MM-DD"};const s=new Date(a);return Number.isNaN(s.getTime())?{valid:!1,error:"Invalid date"}:{valid:!0}}function H(n){const e=c.useRef(null),o=c.useRef(null);return c.useEffect(()=>{const l=n.dataText.split(`
`).map(s=>s.trim()).filter(s=>s.length).filter(s=>R(s).valid).join(`
`);n.setHolidaysData(U(l))},[n.dataText]),c.useEffect(()=>{e.current&&new ResizeObserver(()=>{var a;o.current&&(o.current.style.height=((a=e.current)==null?void 0:a.clientHeight)+"px")}).observe(e.current)},[e.current]),t.jsxs("div",{className:x.container,children:[t.jsxs("label",{htmlFor:"events-data",className:x.label,children:["Calendar events. Format: ",t.jsx("code",{children:"YYYY-MM-DD [icon] event name"}),"."]}),t.jsxs("div",{className:x.wrapper,children:[t.jsx("div",{ref:o,className:x.icons,children:n.dataText.split(`
`).map((a,l)=>{const s=R(a);return t.jsx("div",{"data-tooltip":s.valid?void 0:s.error||"Invalid",className:x.lineRow,children:t.jsx("span",{className:`${x.indicator} ${s.valid?"":x.indicatorInvalid}`,children:s.valid?"":"!"})},l)})}),t.jsx("textarea",{id:"events-data",ref:e,value:n.dataText,onChange:a=>n.setDataText(a.target.value),onScroll:a=>{o.current&&(o.current.scrollTop=a.target.scrollTop)},className:x.textarea})]})]})}const O="_controls_b9359_1",q="_controlsGroup_b9359_13",D={controls:O,controlsGroup:q},z="https://api.codetabs.com/v1/proxy/?quest=";function I(n){return fetch(z+encodeURIComponent(n)).then(e=>e.text()).catch(e=>(console.error(e),""))}const J=({setDataText:n,setHolidaysData:e,holidaysParsed:o})=>{const[a]=y();c.useEffect(()=>{const r=a==null?void 0:a.get("ics");if(r){const i=encodeURI(r+window.location.hash).replace(/#/g,"%23").replace(/@/g,"%40");f(r),I(i).then(h)}},[]);const l=c.useRef(null),s=c.useRef(null),[d,f]=c.useState(""),h=c.useCallback(r=>{const i=E(r);e(i);const v=i.map(u=>`${u.date} ${u.kind==="other"?u.icon:N(u.countryCode)} ${u.name}`).join(`
`);n(v)},[n,e]),m=r=>{var u;const i=(u=r.target.files)==null?void 0:u[0];if(!i)return;const v=new FileReader;v.onload=()=>{h(String(v.result||"")),s.current&&(s.current.value="")},v.readAsText(i)},p=c.useCallback(()=>{var i;const r=((i=l.current)==null?void 0:i.value)||d;r&&I(r).then(h)},[d,h]),g=c.useCallback(()=>{b(o)},[o]);return t.jsxs("div",{className:D.controls,children:[t.jsxs("div",{className:D.controlsGroup,children:[t.jsx("input",{ref:l,value:d,type:"url",onChange:r=>f(r.target.value),placeholder:"Add link to .ICS file"}),t.jsx("button",{onClick:p,children:"Load ICS"})]}),t.jsx("button",{onClick:()=>{var r;return(r=s.current)==null?void 0:r.click()},children:"Import .ics"}),t.jsx("input",{ref:s,type:"file",accept:".ics,text/calendar",style:{display:"none"},onChange:m}),t.jsx("button",{onClick:g,children:"Save to .ics"})]})},K=`
2025-09-10 üéÇ Birthday of Joe
2025-09-19 üéÇ Birthday of Chuck
2025-09-27 üéÇ Birthday of Dima
`,V=()=>{const[n,e]=c.useState([]),{currentDate:o,selectedMonthDays:a,selectedYearDays:l,mode:s,navigateMonth:d,handleModeChange:f,handleDateChange:h}=S(n),[m,p]=c.useState(K.trim());c.useEffect(()=>{const r=localStorage.getItem(C);r!==null&&p(r)},[]),c.useEffect(()=>{localStorage.setItem(C,m)},[m]);const g=c.useCallback(r=>{p(i=>i+`
`+(r.date+" "+r.icon+" "+r.name))},[]);return t.jsxs("div",{className:j.app,children:[t.jsx("div",{className:j.header,children:t.jsx("h1",{children:t.jsx("a",{href:"./",children:"üåç Events Calendar"})})}),t.jsxs("div",{className:j.container,children:[t.jsx(k,{selectedDate:o,onDateChange:h,onNavigateMonth:d}),t.jsx(J,{setDataText:p,setHolidaysData:e,holidaysParsed:n}),t.jsx(w,{selectedYearDays:l,selectedMonthDays:a,currentDate:o,mode:s,countryData:{},onModeChange:f,onNewEvent:g}),t.jsx(H,{setHolidaysData:e,dataText:m,setDataText:p})]})]})};export{V as AnyEvents,V as default};
